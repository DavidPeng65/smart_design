第2章 電路圖與網表操作：PyAEDT 電路設計流程
---

### 電路圖與網表
在電子電路設計的歷史與流程中，原理圖（Schematic）與電路網表（Netlist）是兩個密不可分的核心概念。這兩者的關係既是互補也是轉換的對象，不僅影響著電路的設計方式，也深深牽動後續的模擬、佈局與製造流程。

從歷史角度來看，最早的電路設計並沒有圖形介面，所有的元件與其間的連線關係都是以文字的形式記錄，這就是所謂的 Netlist。Netlist 是一種純文字的資料格式，用來描述電路中每個元件的連接關係。例如：一個電阻 R1 連接在節點 N001 與 N002 之間，會以一行文字表達為：

```
R1 N001 N002 1k
```

這樣的格式雖然對電腦而言非常有效率，但對於人類工程師來說，閱讀與檢查會變得非常困難。特別是當電路變得複雜之後，純文字的表達方式容易出錯，也不利於團隊協作與設計審查。

為了解決這樣的問題，視覺化的設計工具逐漸發展出來，於是「原理圖」這個概念便應運而生。原理圖是一種圖形化的電路表示方法，能以直觀的方式呈現電子元件及其間的連接關係。它不是取代 netlist，而是作為一種更方便編輯與理解 netlist 的工具。

原理圖由幾個基本元素所組成：

1. **Symbol（符號）**：代表元件的圖形，例如電阻、電容、二極體、IC 等，每個 symbol 都有一組標準化圖示。
2. **Pin（腳位）**：symbol 上的接腳，用來標示元件與外界電路連接的位置。
3. **Wire（導線）**：用於將元件間的腳位互相連接，代表實際電氣的連通關係。
4. **Net（電氣節點）**：導線所形成的連接點，會被指定節點名稱，例如 N001、GND 等。

當工程師使用原理圖工具完成設計後，EDA（Electronic Design Automation）軟體會根據原理圖中的元件、腳位與導線自動轉換成對應的 netlist。這個轉換過程稱為 netlist extraction。提取出的 netlist 可供後續使用於 SPICE 模擬、PCB layout、DFM 檢查等。

值得一提的是，雖然現代設計流程多數是「先畫原理圖，再產生 netlist」，但某些底層的自動化流程（例如程式產生電路）或逆向工程，也可能是「先有 netlist，再反推出原理圖」。因此，netlist 與 schematic 是可以互轉的，兩者的資料結構皆有其對應邏輯。

總結來說，Netlist 是電路設計最基礎的語言，而原理圖則是將這些語言視覺化的表達形式。原理圖的發展，極大提升了工程師在電路設計過程中的效率與準確性，使複雜系統的開發成為可能。它們之間的轉換關係，也成為現代電子設計自動化流程中的關鍵一環。

### 三種自動化流程

在電子電路設計的自動化流程中，無論是直接操作電路網表（Netlist）還是透過建立原理圖（Schematic），都可以達到模擬與後處理的目的，端看使用者對速度、圖形化界面需求與靈活性的取捨。

#### 1. nexxim.exe
第一種方式是直接編輯 Netlist。使用者可以以文字方式撰寫或修改電路的 netlist 檔案，然後透過指令列工具，如 `nexxim.exe xxx.cir` 來執行模擬，並將結果輸出為 `.sdf` 檔案。這個 `.sdf` 檔案接著可以轉換為 `.csv` 檔，以利進一步分析或資料儲存。

此流程適用於 AC 分析或 Transient 分析，能夠輸出指定節點的電壓與電流資料。由於不透過 GUI，也不需使用 GUI license，因此速度極快，是所有方式中效率最高者。但其缺點也很明顯：它不直接支援複雜的後處理功能，也無法自動產生圖表。若需要視覺化資料，通常需配合 Python 第三方模組（例如 `matplotlib`）手動完成分析與繪圖。

#### 2. netlist 加入
第二種方式是將 netlist 檔案路徑載入 AEDT 環境中，結合模擬設定進行計算。此方法執行速度略慢於第一種，但模擬結束後可直接使用 AEDT 內建的後處理功能來分析結果或產生圖表。這對需要更深入分析的工程應用來說，是一種較為穩定且兼顧效率與功能性的方案。

#### 3. 建立schematic
第三種方式是透過程式碼建立原理圖。這種方式模擬了手動繪製原理圖的流程，只是改以程式語言（如 Python 搭配 PyAEDT）來完成元件放置與導線連接。這種方法的優點是直覺性高，結構清晰，對於視覺確認電路設計特別友善。然而其模擬速度最慢，尤其在原理圖複雜時，更容易耗費資源。


#### 總結

- **直接編輯 netlist 執行模擬**：最快，不需 GUI license，適合高效批次處理。
- **netlist 結合 AEDT 執行模擬與後處理**：功能平衡，速度尚可。
- **程式碼建立 schematic（模擬手動操作）**：最直覺，速度最慢。

### 練習:

#### 1. 開啟與建立設計
- 開啟一個新專案
- 建立一個 Circuit Design，命名為 Circuit1

#### 2. 放置元件及模擬埠並設定
- 放入三個元件：電阻（R）、電感（L）、電容（C）
- 照電路圖將元件相連
- 將電阻的數值設定為 0.1Ω
- 在電路兩端分別建立 Port1 和 Port2
![2025-03-29_13-12-30](/assets/2025-03-29_13-12-30.png)

#### 3. 設定並執行模擬
- 建立線性頻率分析（LinearFrequency）
  - 掃描頻率從 0GHz 到 1GHz，共 10 個點
- 執行模擬
- 畫出 S(Port2, Port1) 的 dB 圖

#### 5. 建立 Netlist 版本並比較
- 開啟原本模擬結果的網表（Netlist），複製內容到文字編輯器
- 修改元件值：L=2e-9、C=2e-12，刪除Ports與.LNA，並存成檔案 rlc.cir
- 新增另一個 Circuit Design，匯入剛剛的網表，並加入Port1, Port2。
- 建立相同的模擬設定並執行
- 畫出新的 S(Port2, Port1) 的 dB 圖
- 比較兩張圖的差異，觀察元件數值變化對電路響應的影響

**檢視網表**
![2025-03-29_13-31-32](/assets/2025-03-29_13-31-32.png)

**建立rlc.cir**
```netlist
R1 Port1 net_1 0.1 
L2 net_1 Port2 L=2e-09
C3 0 net_1 2e-12
```
**匯入rlc.cir**
![2025-03-29_13-17-15](/assets/2025-03-29_13-17-15.png)

**加入Port1, Port2**
![2025-03-29_13-28-38](/assets/2025-03-29_13-28-38.png)

**比較圖表**
![2025-03-29_13-20-31](/assets/2025-03-29_13-20-31.png)


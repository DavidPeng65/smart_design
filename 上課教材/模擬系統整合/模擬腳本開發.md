模擬腳本開發
---

完整模擬流程由許多步驟組成，每個步驟都代表模擬過程中的一個特定操作或決策點。這些步驟可以包括數據輸入、參數設置、模擬運行、結果分析等。通過將這些步驟串聯起來，形成一個完整的模擬流程。

每個步驟都有一個對應的PyAEDT/PyEDB腳本片段，這些腳本片段負責執行該步驟的具體操作。例如，數據輸入步驟可能涉及讀取外部文件並將數據加載到模擬環境中，而模擬運行步驟則可能包括設置模擬參數並啟動模擬過程。

通過將這些腳本片段組合在一起，可以構建一個完整的模擬腳本，該腳本能夠自動執行整個模擬流程。這種方法不僅提高了模擬的效率，還減少了手動操作的錯誤風險。

這些腳本都放置在src/scripts目錄下，作為基本元件，可以讓不同的流程進行調用和組合。用戶可以根據自己的需求，選擇合適的腳本片段來構建自己的模擬流程。例如Import.py腳本讓用戶可以輕鬆導入brd模型，這是所有SI/PI模擬的第一步。

```
import sys
import os
import json
from collections import defaultdict
from pyedb import Edb

# Expects a single argument: the path to the project.json file
if len(sys.argv) != 2:
    print("Usage: python get_edb.py <project_file_path>")
    sys.exit(1)

project_file = sys.argv[1]

if not os.path.exists(project_file):
    print(f"Error: Project file not found at {project_file}")
    sys.exit(1)

try:
    with open(project_file, "r") as f:
        project_data = json.load(f)
except json.JSONDecodeError:
    print(f"Error: Could not decode JSON from {project_file}")
    sys.exit(1)

# Read parameters from the JSON file
design_path = project_data.get("aedb_path")
edb_version = project_data.get("edb_version")
input_xml_path = project_data.get("stackup_path")
```

這些腳本都是通過json文件來傳遞參數，讀取所需參數來執行工作，並將結果也寫回json文件中，方便後續腳本調用。例如上面的腳本片段讀取了一個project.json文件來獲取aedb_path、edb_version和stackup_path等參數，然後可以使用這些參數來打開對應的EDA文件並進行操作。

透過json文件來傳遞參數和結果，使得不同腳本之間可以方便地進行數據交換和協同工作。對腳本而言，也只需要關注自己的功能實現，而不需要關注是誰在調用自己，系統級的調用方式也可以缺保資源的統一管理和調度。

單一功能原則確保每個腳本專注於完成一個特定任務，這樣可以提高代碼的可維護性和可重用性。當需要修改或擴展某個功能時，只需更新相應的腳本，而不會影響整個模擬流程。

需要注意的是，這部分應該由開發者自行根據需求來編寫腳本，可以部份交由AI偕同開發，但最終的腳本需要經過測試和驗證，以確保其正確性和穩定性。不應該由AI完全自動生成，因為模擬腳本通常需要根據具體的模擬需求和環境進行調整和優化。開發者必須完全了解邏輯與流程，才能確保腳本的有效性。
物理工程模擬平台開發
---

### 腳本開發進階
腳本廣泛應用在物理工程模擬軟體當中，用於自動化重複性任務、定義模擬參數以及控制模擬流程。腳本語言如Python、Lua或JavaScript通常被用來編寫這些腳本，因為它們易於學習且具有強大的功能。

雖然腳本可以顯著提高模擬的效率和靈活性，但在開發過程中也會面臨一些挑戰。例如，腳本的性能可能不如原生代碼，特別是在處理大量數據或複雜計算時。此外，腳本的可維護性和可讀性也是需要考慮的重要因素，特別是在多人協作的項目中。

另外，許多工程模擬背景的工程師並不熟悉程式語言，排斥使用腳本來進行模擬設定與控制。因此，在設計腳本系統時，應該考慮提供友好的用戶界面和豐富的文檔，以降低學習曲線並促進使用者採用。

對於開發腳本的工程師來說，理解模擬軟體的內部結構和數據流是至關重要的。並且需要搭建可以讓一般使用者容易上手的操作介面，以便他們能夠有效地利用腳本來完成模擬任務。

### 對腳本開發者的挑戰

首先，腳本開發者需要深入了解模擬軟體的API和功能，以便能夠有效地利用這些資源來實現所需的模擬任務。這可能需要花費大量時間來學習和實驗。另外，腳本開發者還需要考慮腳本的性能優化，特別是在處理大型模擬時，確保腳本能夠高效運行而不會成為瓶頸。

此外，腳本開發者還需要面對使用者需求的多樣性。不同的使用者可能有不同的模擬需求和工作流程，因此腳本需要具有足夠的靈活性和可配置性，以滿足這些需求。這可能需要開發者設計出通用且易於擴展的腳本結構。

腳本開發者還需要考慮腳本的可維護性和可讀性。良好的程式設計原則和編碼標準應該被遵循，以確保腳本能夠被其他開發者理解和修改。此外，提供豐富的文檔和範例也是非常重要的，這將有助於使用者更好地理解和使用腳本。

GUI框架邏輯與一般腳本相當不同，需要學習如何設計和實現圖形用戶界面，這對於腳本開發者來說可能是一個新的挑戰。腳本開發者需要掌握GUI設計的基本原則，並了解如何使用相關的GUI庫和工具來創建直觀且易於使用的界面。

最後要能連結工程腳本與GUI框架，並確保中間耦合度低，這樣才能讓腳本和GUI能夠協同工作，提供更好的用戶體驗。這可能需要開發者具備跨領域的知識和技能，以便能夠有效地整合這兩個方面的功能。還要能確保之後的擴充性，讓未來能夠方便地添加新的功能和改進。

### AI Agent與腳本開發人員的技術分工

隨著人工智慧技術的進步，AI Agent在物理工程模擬中的應用越來越廣泛。AI Agent可以自動化許多重複性任務，並且能夠根據使用者的需求進行智能化的決策和操作。這對於腳本開發人員來說，既是一個機遇也是一個挑戰。

AI最大的困難是對於專業領域知識的理解和應用。物理工程模擬涉及複雜的數學模型和物理原理，缺乏專業領域知識，AI編寫的腳本無法正常運作，但是在GUI及操作流程的設計上，AI Agent可以提供很大的幫助。腳本開發人員可以專注於編寫核心的模擬邏輯和算法，而將GUI設計和用戶交互部分交給AI Agent來處理。這樣的分工可以提高整體開發效率，並且讓腳本開發人員能夠專注於他們擅長的領域。

具體作法是，腳本開發人員可以負責設計和實現模擬的核心功能和算法，確保模擬的準確性和性能。同時，AI Agent可以負責生成和優化GUI界面，根據使用者的反饋進行調整和改進。這樣的分工可以充分利用AI的優勢，同時保證模擬的專業性和可靠性。

話雖如此，腳本開發人員仍然需要具備一定的GUI設計知識，對於GUI框架的基本原理和設計模式有所了解。這樣才能更好地讓AI Agent生成符合需求的GUI界面及框架，並且讓AI Agent能夠理解操作流程的邏輯需求。這需要開發者定義清晰的接口和規範，以便AI Agent能夠有效地整合腳本和GUI框架。

### 框架設計
在設計腳本與GUI框架的整合時，應該考慮以下幾個方面：
1. **模組化設計**：將腳本和GUI框架設計為獨立的模組，通過明確的接口進行通信。這樣可以降低耦合度，方便後續的維護和擴展。
2. **靈活的配置**：提供靈活的配置選項，允許使用者根據需求自定義腳本和GUI的行為。這可以通過配置文件或參數設置來實現。
3. **事件驅動架構**：採用事件驅動的架構，使得腳本和GUI能夠根據使用者的操作和模擬狀態進行動態調整。這有助於提高系統的響應速度和用戶體驗。
4. **錯誤處理和日誌記錄**：設計完善的錯誤處理機制和日誌記錄功能，方便開發者和使用者進行問題排查和性能分析。
5. **測試和驗證**：建立完善的測試和驗證流程，確保腳本和GUI框架的功能正確性和穩定性。這可以包括單元測試、集成測試和用戶測試等多種方式。

通過以上的設計原則，可以有效地整合腳本和GUI框架，提升物理工程模擬的效率和用戶體驗。同時，這也為腳本開發人員和AI Agent之間的協作提供了良好的基礎，促進了技術的融合和創新。

### 模擬自動化系統

PyQt或PySide是常用的Python GUI框架，可以用來設計和實現模擬自動化系統的圖形用戶界面。這些框架提供了豐富的UI元件和工具，方便開發者創建直觀且易於使用的界面。

模擬自動化系統通常包括以下幾個主要功能模組：
1. GUI 框架模組：負責設計和實現用戶界面，提供操作面板、參數設置和結果顯示等功能。
2. 模擬流程介面及資料交換模組：負責定義模擬的工作流程，並實現與模擬引擎之間的數據交換和通信。
3. 腳本控制模組：負責模擬軟體資訊讀取和執行，實現自動化的模擬任務。

這些模組之間需要通過明確的接口進行通信和協作，以確保整個系統的穩定性和可擴展性。開發者可以根據具體的需求和場景，選擇合適的框架和技術來實現模擬自動化系統。

### 範例架構
以下是一個簡單的模擬自動化系統架構範例：

```plaintext
d-----      2025/10/18  下午 01:22                .venv
d-----      2025/10/21  上午 07:53                apps
d-----      2025/10/23  下午 01:35                images
d-----      2025/10/23  下午 02:51                src
d-----      2025/10/24  下午 03:14                temp
-a----      2025/10/23  上午 04:41            119 .gitignore
-a----      2025/10/24  下午 03:09          13413 architecture.md
-a----      2025/10/23  下午 03:39         509801 batch.log
-a----      2025/10/12  下午 07:49           3372 install.ps1
-a----      2025/10/23  下午 02:53           1050 LICENSE
-a----      2025/10/12  上午 09:39            118 main.bat
-a----      2025/10/20  上午 10:28           2092 README.md
-a----      2025/10/18  下午 01:39           1225 requirements.txt
```
在這個範例中，`src`目錄包含了主要的程式碼和模組，`apps`目錄可以用來存放不同的應用程式或工具，`images`目錄用於存放相關的圖片資源，而`.venv`目錄則是Python虛擬環境，用於隔離和管理專案的依賴包。

src目錄下可以進一步劃分為不同的模組，例如GUI框架模組、模擬流程介面模組和腳本控制模組等。這樣的結構有助於保持程式碼的整潔和可維護性，方便開發者進行協作和擴展。

```
Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----      2025/10/23  上午 08:43                scripts
d-----      2025/10/20  上午 09:23                services
d-----      2025/10/23  下午 02:53                tabs
d-----      2025/10/23  上午 05:00                tools
d-----      2025/10/24  下午 03:14                __pycache__
-a----      2025/10/24  下午 03:06          11311 gui.py
-a----      2025/10/19  下午 02:32            428 main.py
```
在`src`目錄下，`gui.py`文件負責實現圖形用戶界面，`main.py`文件則是系統的入口點，負責啟動整個模擬自動化系統。其他子目錄如`scripts`、`services`、`tabs`和`tools`則可以用來存放不同的功能模組和工具，根據具體需求進行劃分和組織。

```
    目錄: D:\OneDrive - ANSYS, Inc\a-client-repositories\lmz-siwave-SI-2025-10-17\SI Automation Flow\src\scripts


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----      2025/10/22  上午 10:22                __pycache__
-a----      2025/10/19  上午 10:46           6148 generate_report.py
-a----      2025/10/23  下午 03:25           2287 get_edb.py
-a----      2025/10/19  上午 10:46           3569 get_loss.py
-a----      2025/10/23  下午 01:52            258 modify_xml.py
-a----      2025/10/22  上午 08:59          21319 run_cct.py
-a----      2025/10/19  上午 10:46            760 run_sim.py
-a----      2025/10/23  下午 03:25            964 set_edb.py
-a----      2025/10/19  上午 10:46           1117 set_sim.py
```

在`scripts`目錄下，包含了多個腳本文件，每個文件負責不同的功能模組。例如，`generate_report.py`用於生成模擬報告，`get_edb.py`和`set_edb.py`用於讀取和設置EDB數據，`run_sim.py`負責執行模擬任務等。這樣的結構有助於保持腳本的組織性和可維護性，方便開發者進行協作和擴展。

這些都是與模擬自動化系統相關的腳本文件，功能單一且方便測試，GUI透過Qprocess來呼叫這些腳本進行模擬任務的執行和控制。可以將資訊傳遞給腳本，並接收腳本的輸出結果，實現模擬流程的自動化和管理。也方便測試與除錯。

```
    目錄: D:\OneDrive - ANSYS, Inc\a-client-repositories\lmz-siwave-SI-2025-10-17\SI Automation Flow\src\tabs


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----      2025/10/23  下午 03:21                __pycache__
-a----      2025/10/22  上午 10:26          20052 cct_tab.py
-a----      2025/10/23  上午 03:39           1210 help.py
-a----      2025/10/23  下午 01:45          10317 import_tab.py
-a----      2025/10/23  下午 03:21           4011 license_tab.py
-a----      2025/10/22  上午 10:18          19952 port_setup_tab.py
-a----      2025/10/20  下午 12:57           6017 result_tab.py
-a----      2025/10/20  下午 12:57           8613 simulation_tab.py
-a----      2025/10/22  下午 08:37           5379 table.py
```

在`tabs`目錄下，包含了多個與GUI選項卡相關的模組文件。例如，`cct_tab.py`負責CCT選項卡的功能實現，`import_tab.py`用於導入數據的選項卡，`license_tab.py`處理授權相關的功能等。這些模組有助於將不同的功能區分開來，提升系統的可維護性和擴展性。


每個tab .py模組負責實現特定選項卡的功能，並與主GUI框架進行交互。這樣的設計有助於保持程式碼的模組化和可維護性，方便開發者進行協作和擴展。

```
    目錄: D:\OneDrive - ANSYS, Inc\a-client-repositories\lmz-siwave-SI-2025-10-17\SI Automation Flow\src\services


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----      2025/10/20  上午 09:22                __pycache__
-a----      2025/10/19  下午 07:18           1489 app_state_store.py
-a----      2025/10/19  下午 06:55          11169 external_script_runner.py
-a----      2025/10/19  下午 07:18            224 __init__.py
```

在`services`目錄下，包含了一些服務模組文件。例如，`app_state_store.py`負責應用狀態的存儲和管理，`external_script_runner.py`用於執行外部腳本等。這些服務模組有助於提供系統的核心功能和支持，提升整體的穩定性和性能。

這個框架以GUI為核心，結合腳本控制和模擬流程介面，可以彈性地應對不同的模擬需求和場景。開發者可以根據具體的需求進行擴展和定制，打造符合特定應用的模擬自動化系統。

### 開發者對於框架的掌握

當需要添加流程時，開發者需要知道如何復用現有的腳本模組，並將它們整合到新的流程中。比方說，假設已有一個腳本模組用於設置導入版圖設計，開發者可以直接調用這個模組來完成導入步驟，而不需要重新編寫相關的代碼。這樣可以提高開發效率，並且減少錯誤的可能性。

當流程當中需要新增步驟時，開發者需要了解如何設計和實現新的腳本模組，並將其與現有的流程進行整合。例如，假設需要新增一個步驟來進行模擬結果的分析，開發者可以編寫一個新的腳本模組及tab模組，並將其插入到現有的流程中。這樣可以確保新的功能能夠順利地與現有系統協同工作。

此外，框架當中依循定義好的json來傳遞參數與資訊，開發者需要熟悉這些json結構，以便能夠正確地讀取和寫入相關的數據。這樣可以確保不同模組之間的通信和協作能夠順利進行，並且避免因為數據格式不一致而導致的錯誤。

掌握框架，便可以先編寫與工程模擬軟體的互動腳本模組，並完善定義其與json參數結構，完成測試並加入到src目錄下的scripts目錄。接著，讓AI Agent生成對應的tab模組。接下來讓AI Agent生成新的流程模組, 放在Apps/當中


```
    目錄: D:\OneDrive - ANSYS, Inc\a-client-repositories\lmz-siwave-SI-2025-10-17\SI Automation Flow\apps\cct


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----      2025/10/23  上午 03:25                __pycache__
-a----      2025/10/24  下午 03:04           1117 config.json
-a----      2025/10/23  上午 03:25           2782 controller.py
-a----      2025/10/23  上午 03:39             59 help.md
-a----      2025/10/22  上午 09:16             67 __init__.py
```

在`apps`目錄下，包含了不同的應用程式或工具模組。例如，`cct`目錄下包含了與CCT相關的應用程式模組，包括配置文件`config.json`、控制器`controller.py`和幫助文檔`help.md`等。這些應用程式模組可以根據具體的需求進行擴展和定制，提供特定的功能和服務。

通過以上的設計和結構，開發者可以有效地掌握模擬自動化系統的框架，並可以根據具體的需求進行prompt設計與開發工作。也可以判斷AI Agent些改及擴展是否在合適的範圍，例如一個tab模組或腳本模組的修改，應該侷限在該模組內，或是整個GUI的流程邏輯需要調整，則AI Agent應改是在gui.py或main.py進行修改。這個判斷能力非常重要，能夠確保系統的穩定性和可維護性。，並且能夠有效地利用AI Agent來提升開發效率和質量。

### 與AI Agent協作開發心法

每一次啟動AI Agent進行開發前，先讓其先review目前的程式碼架構與模組，了解目前的設計邏輯與分工。最好可以建立architecture.md文件，讓AI Agent可以參考。

接著再進行具體的開發任務指示，如果因為知識缺乏無法下達精確的prompt，可以先讓AI Agent提出開發計畫與步驟，並且讓其列出需要的資訊與知識，然後再針對這些資訊進行補充與說明。這樣可以確保AI Agent能夠充分理解開發需求，並且能夠有效地完成任務。

互動過程當中，隨時注意AI Agent的回應與產出，確保其符合預期的要求。如果發現有任何偏差或錯誤，及時進行調整和修正，並且提供具體的反饋和指導。並要求將理解錯誤的地方記錄到architecture.md當中，避免下次再犯相同的錯誤。

就像經理教導新進員工，先用引導提問讓AI Agent回答並提出計畫，針對計畫逐條確認與補充細節，錯誤時給予反饋並要求改進，持續迭代直到計畫無誤，然後再進行開發工作。透過工作紀錄簿(architecture.md)來累積知識與經驗，讓AI Agent能夠不斷學習和成長，提升其開發能力和效率。

這個開發心法不僅適用於AI Agent，也適用於人類開發者的成長過程。由於AI Agent對於一般GUI或大型框架的理解比起開發者要強的多，只是卻乏領域知識，因此透過這樣的協作方式，開發者也可以從AI Agent身上學習到更多的技術和經驗，提升自己的開發能力和水平。

由於AI Agent有記憶的上限，因此建議每次開發任務都需要持續更新architecture.md文件，並且在每次啟動AI Agent時，先讓其review這個文件，以便能夠充分利用之前的知識和經驗，提升開發效率和質量。

### 結論
模擬自動化系統的開發是一個複雜且具有挑戰性的任務，需要開發者具備多方面的知識和技能。通過合理的框架設計和模組化結構，可以有效地提升系統的可維護性和擴展性。同時，與AI Agent的協作開發也能夠顯著提高開發效率和質量。開發者需要不斷學習和掌握新的技術和工具，並且能夠靈活應對不同的需求和場景。通過持續的改進和優化，可以打造出高效且易於使用的模擬自動化系統，滿足物理工程模擬的各種需求。


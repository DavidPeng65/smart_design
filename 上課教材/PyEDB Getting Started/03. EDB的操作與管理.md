第3章 EDB的操作與管理
---

### 3.1 建立空白的AEDB檔案

建立新 .aedb 檔案的最簡單方法如下：


```python
from pyedb import Edb

# 建立 EDB 物件並指定版本
edb = Edb(edbversion='2024.1')

# 儲存為新檔案
edb.save_as('c:/demo/new.aedb')

# 關閉 EDB
edb.close_edb()
```
導入 3D Layout 後，設計名稱（cell name）會自動分配為變數，例如：`Cell_R8XP27`。

![2024-10-14_10-19-13](/assets/2024-10-14_10-19-13.png)

### 3.2 Edb 函式詳解與參數說明

`Edb` 函式是 ANSYS PyAEDT 庫中提供的一個核心接口，用來與 EDB（Electronics Database）進行互動。該函式提供了一個靈活的方式來打開、建立或轉換電子設計資料。它涵蓋了多種操作模式，例如讀寫模式的選擇、EDB 版本的設定，以及是否從 HFSS 3D Layout 啟動等。以下是其參數的詳細解釋：
#### 參數詳解 
 
1. **`edbpath`**  (`str`, optional): 
  - 指定 `.aedb` 資料夾的完整路徑。這個變數也可以包含將要匯入的佈局檔案的路徑，支援的格式包括 `.BRD`、`.XML` (IPC2581)、`.GDS` 和 `.DXF`。
 
  - 預設值為 `None`，表示如果不指定路徑，則可能會建立一個新的 EDB 或執行其他操作。
 
  - 若匯入 `.GDS` 檔案，則 Ansys 控制檔案（通常是 `.XML` 格式）必須與 `.GDS` 檔案同名，唯獨副檔名不同。
 
2. **`cellname`**  (`str`, optional): 
  - 指定要選擇的設計單元（Cell）的名稱，這是 EDB 的內部結構之一。若未指定，則使用預設值 `None`，表示可能會自動選擇或建立新單元。
 
3. **`isreadonly`**  (`bool`, optional):
  - 設定是否以只讀模式開啟 EDB，尤其是在該 EDB 由 HFSS 3D Layout 所擁有時很有用。
 
  - 預設為 `False`，表示允許寫入操作。
 
4. **`edbversion`**  (`str`, optional):
  - 指定要使用的 EDB 版本。這個參數允許使用者指定不同版本的 EDB 來處理資料，以確保與特定版本的相容性。
 
  - 預設為 `"2021.2"`。
 
5. **`isaedtowned`**  (`bool`, optional):
  - 用來指定是否從 HFSS 3D Layout 啟動 EDB。這個選項對於從 HFSS 3D Layout 直接開啟 EDB 非常有用。
 
  - 預設為 `False`。
 
6. **`oproject`**  (optional):
  - AEDT 專案物件的參考。這個參數允許與現有的 AEDT 專案連接，以便進行更深層的資料互動。
 
7. **`student_version`**  (`bool`, optional):
  - 指定是否開啟 AEDT 的學生版本。如果使用學生版本，某些功能或資源可能受限。
 
  - 預設為 `False`。
 
8. **`technology_file`**  (`str`, optional): 
  - 提供一個技術檔案（technology file）的完整路徑，這個檔案會在匯入前轉換為 XML 格式，適用於 `.GDS` 檔案的情況。該檔案包含關於佈局的技術資料，對於確保正確的資料轉換至關重要。

#### 返回值 
 
- 這個函式會返回兩種可能的物件類型： 
  1. **`pyedb.dotnet.edb.Edb`** ：適用於基於 .NET 的 EDB 接口。
 
  2. **`pyedb.grpc.edb.Edb`** ：適用於基於 gRPC 的 EDB 接口。

這些物件提供了對 EDB 的全面控制，允許使用者在 Python 程式中操作 EDB，執行如資料讀取、模擬設置以及與其他工具（如 HFSS 和 SIwave）整合的操作。

#### 常見用例 
 
1. **開啟現有的 EDB 檔案** ：

```python
from pyedb import Edb
edb = Edb(edbpath='path/to/existing.aedb')
```
 
2. **建立新的 EDB 檔案並指定版本** ：

```python
edb = Edb(edbversion='2024.1')
edb.save_as('c:/demo/new.aedb')
edb.close_edb()
```
 
3. **匯入 BRD 或 GDS 檔案並轉換為 EDB 格式** ：

```python
edb = Edb(edbpath='path/to/file.brd')
edb.save_as('path/to/newfile.aedb')
```

這樣的接口讓使用者能夠靈活處理不同類型的 PCB 設計檔案，並在 ANSYS 產品中進行進一步模擬或分析。

### 3.3 查詢資料庫


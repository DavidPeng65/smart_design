輸出切片電場圖片
---

這段程式碼的主要目的是使用 PyAEDT 自動產生三個主平面（XY、YZ、ZX）上多個切面的電場強度視覺化圖，並將這些圖以圖片檔案形式儲存在指定的資料夾中。此作法有助於快速觀察與分析模擬模型內部在不同空間位置的電場分佈情形。

### 流程架構

1. **初始化與環境設定**：

   * 指定輸出圖片儲存的資料夾 `output_directory`
   * 匯入必要模組：`os`, `pyaedt.Hfss`, `numpy.arange`
   * 啟動 HFSS 並開啟一個專案實例

2. **取得模型邊界**：

   * 使用 `get_model_bounding_box()` 抓取目前模型的邊界座標，方便接下來沿三個方向建立等距平面。

3. **逐軸建立切面與輸出影像**：

   * **YZ 平面**（沿 X 軸掃描）：

     * 固定 x 座標，建立多個垂直於 X 軸的矩形切面。
     * 為每個切面建立電場強度圖，並匯出為圖片檔。
   * **ZX 平面**（沿 Y 軸掃描）：

     * 固定 y 座標，掃描並產生垂直於 Y 軸的切面。
     * 建立對應的視覺圖與輸出圖片。
   * **XY 平面**（沿 Z 軸掃描）：

     * 固定 z 座標，產生一系列水平切面。
     * 繪製與匯出相對應的電場強度圖。
   * 每次產生的 polyline 切面會在匯出後立即刪除，避免影響後續操作。

### 補充說明

* **`pyaedt`**：這是一個 Python 封裝函式庫，用來操控 Ansys 的電子模擬軟體（例如 HFSS），可進行建模、自動化模擬、結果處理等。
* **`create_polyline(..., non_model=True, cover_surface=True)`**：這個方法用來建立臨時的切面幾何，`non_model=True` 表示這個幾何不會影響模型模擬結果，只用於視覺化；`cover_surface=True` 則讓 polyline 自動填成一個面。
* **`arange()`**：這是 numpy 提供的函式，用來產生一系列等間距的數值。這邊是根據模型邊界的座標，決定掃描的範圍與步距。
* **`create_fieldplot_surface`**：產生特定面上的場圖，這裡設定為 `Mag_E`（電場大小）。
* **`orientation='isometric'`**：匯出圖像時的視角設定為等角視圖，方便觀察空間結構。

這段程式碼非常適合用於後處理分析，需要大量視覺化截面圖時的自動化流程。


```python
output_directory = 'd:/demo'

import os
from pyaedt import Hfss
from numpy import arange
hfss = Hfss(version='2025.1')

x0, y0, z0, x1, y1, z1 = hfss.modeler.get_model_bounding_box()

#%%
for x in arange(x0, x1):
    s = hfss.modeler.create_polyline([(x, y0, z0), (x, y0, z1), (x, y1, z1), (x, y1, z0)],non_model=True, cover_surface=True)
    plot = hfss.post.create_fieldplot_surface([s.name], 'Mag_E')
    plot.export_image(os.path.join(output_directory, f'yz_{x}.png'), orientation='isometric')
    s.delete()

for y in arange(y0, y1):
    s = hfss.modeler.create_polyline([(x0, y, z0), (x0, y, z1), (x1, y, z1), (x1, y, z0)],non_model=True, cover_surface=True)
    plot = hfss.post.create_fieldplot_surface([s.name], 'Mag_E')
    plot.export_image(os.path.join(output_directory, f'zx_{y}.png'), orientation='isometric')
    s.delete()


for z in arange(z0, z1):
    s = hfss.modeler.create_polyline([(x0, y0, z), (x0, y1, z), (x1, y1, z), (x1, y0, z)],non_model=True, cover_surface=True)
    plot = hfss.post.create_fieldplot_surface([s.name], 'Mag_E')
    plot.export_image(os.path.join(output_directory, f'xy_{z}.png'), orientation='isometric')
    s.delete()
```

![2025-05-12_14-26-24](/assets/2025-05-12_14-26-24.png)
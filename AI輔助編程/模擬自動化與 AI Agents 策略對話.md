模擬自動化與 AI Agents 策略
---
**以下內容為Google GeminiPro 2.5生成，與真實人事物無關。**

### 場景

**時間：** 一個陽光普照的週三上午。
**地點：** ANSYS 台灣辦公室，一間能俯瞰市景的高樓層會議室。
**人物：**
*   **Alex：** 一位充滿活力的開發者，約莫三十歲出頭，任職於一家快速成長的科技公司。他的團隊負責高速電子產品的研發，近期被複雜的模擬流程搞得焦頭爛額。他穿著休閒的Polo衫和牛仔褲，眼神中透露出對技術的熱情與一絲困惑。
*   **Mr. Lin：** ANSYS 的資深應用工程師，年近五十，經驗豐富，氣質沉穩。他穿著燙得筆挺的襯衫，舉手投足間充滿了專家的自信。桌上放著他的筆記型電腦，螢幕上顯示著一個複雜的 3D 電磁場模型。


### 對話開始

**(會議室的門輕輕關上，隔絕了外面的喧囂。Alex 和 Mr. Lin 握了手，在會議桌兩側坐下。桌上擺放著兩杯冒著熱氣的咖啡。)**

**Alex：** Lin 經理，非常感謝您今天能撥出時間。我先自我介紹一下，我是 Alex，目前在我們公司的硬體研發部門擔任開發工程師。我們最近在產品開發上遇到了一些瓶頸，特別是在電磁模擬這一塊，所以想來請教您這位專家。

**Mr. Lin：** (微笑著點了點頭) Alex，別客氣。你們公司一直是我們重要的合作夥伴。請說說看，遇到了什麼樣的挑戰？我很樂意聽聽，看有什麼可以幫得上忙的地方。

**Alex：** 好的。簡單來說，就是「複雜度」與「效率」的矛盾。現在的產品，不管是 5G 通訊、AI 加速卡，還是高頻的記憶體介面，設計都越來越複雜。PCB 的層數動輒二十幾層，訊號速率也從 Gbps 往數十 Gbps 邁進。這意味著我們的模擬分析工作量呈指數級增長。每一個微小的設計變更，比如換個電容、微調一下走線，理論上都應該要跑一次完整的 SI/PI (信號完整性/電源完整性) 模擬驗證。

**Mr. Lin：** 我完全理解。這是整個產業的共同挑戰。

**Alex：** 是的。而我們現在最大的痛點是，大部分模擬流程還是高度依賴手動操作。我們的工程師每天花費大量時間在 AEDT 的 GUI 介面上，重複著設定材料、指定 Port、配置 Solver、劃分網格這些操作。這不僅耗時，而且極易出錯。你知道的，少點了一個 Net，或者材料屬性填錯一個數字，整個模擬結果可能就天差地別，等結果跑了十幾個小時出來才發現，那種挫敗感真的很重。而且，不同工程師的操作習慣不一，也很難保證模擬設置的一致性。

**Mr. Lin：** 你提到了所有手動操作的典型問題：效率低落、人為疏失、缺乏一致性。這也正是我們 ANSYS 近年來大力推動「模擬流程自動化」的原因。你接觸過 PyAEDT 嗎？

**Alex：** 有的！這正是我今天想跟您深入探討的重點。我們團隊已經開始嘗試用 Python 搭配 PyAEDT 來做一些簡單的自動化。比如，寫個腳本批次匯出 S-parameter 數據，或者自動產生一些標準化的報告。這確實解決了一部分問題，但我們想做得更徹底——我們希望實現一個從頭到尾、端到端的全自動化流程。

**(Alex 的語氣變得更加興奮，他將自己的筆電轉向 Mr. Lin，螢幕上顯示著一些 Python 腳本的片段。)**

**Alex：** 我的初步想法是，能不能利用現在最火的 AI，特別是大型語言模型 (LLM)，來幫我們生成這些自動化代碼？我試過把我們的需求，像是「請用 PyAEDT 寫一個腳本，自動為我 PCB 上所有的 DDR4 訊號線建立 Wave Port」，丟給像 ChatGPT 這樣的模型。它確實能給我一些看起來像樣的代碼，但……說實話，幾乎沒有一次產出的代碼是能直接運行的。

**Mr. Lin：** (他扶了扶眼鏡，饒有興致地看著 Alex 的螢幕) Alex，你這個想法非常前瞻，而且你遇到的問題，也正是目前 AI 在專業工程領域應用的核心障礙。你覺得，為什麼 LLM 難以直接產出「完整且可用」的模擬自動化代碼？

**Alex：** 我猜……是因為它沒有足夠的「養分」？我的意思是，這些通用 LLM 的訓練資料大多來自公開的網路，比如 Stack Overflow、GitHub 上的開源專案。但像 ANSYS AEDT 這種高度專業化的商業軟體，其自動化腳本的範例、最佳實踐、以及那些隱藏在 GUI 操作背後的複雜邏輯，在公開領域的資料量相對稀少。AI 不知道我們公司內部的命名規則，不知道 HFSS 中 ‘Tau’ 和 ‘Lambda’ 網格劃分的細微差別，更不懂我們面對的特定物理場景。

**Mr. Lin：** 完全正確！你說到了點子上。這就是「缺乏足夠的領域專屬訓練資料」的問題。AI 就像一個博學的通才，它知道 Python 語法，甚至能模仿 PyAEDT 的函數命名風格，但它缺乏一位資深模擬工程師的「內隱知識 (Tacit Knowledge)」。它不知道為什麼在設置 Port 的時候，那個參考平面要選在那裡；它也不知道為什麼對於某種特定的結構，用 Tau 網格會比用 Lambda 網格收斂得更快、更準。所以，它給你的代碼，往往是語法上看似正確，但在工程邏輯上卻漏洞百出。

**Alex：** 沒錯！就是這種感覺。我們花了好多時間去 Debug AI 生成的代碼，有時候甚至比自己從頭寫還要累。所以我們團隊內部也有些爭論，覺得 AI 是不是只是個噱頭，對於我們這種嚴肅的工程開發，其實幫助有限。

**Mr. Lin：** 我不這麼認為。問題不在 AI 本身，而在於我們「如何與 AI 協作」。我們需要換一種思維模式。與其期待 AI 成為一個無所不知的「全自動代碼生成器」，不如把它定位成一個能力極強、但需要明確指令的「實習工程師」。而我們，作為領域專家，則扮演「資深導師」的角色。

**(Mr. Lin 站起身，走到會議室的白板前，拿起一支馬克筆。)**

**Mr. Lin：** 讓我們來談談一個更務實的 AI 策略，我稱之為「資料導向編程 (Data-Driven Programming)」或「專家引導的 AI 生成 (Expert-Guided AI Generation)」。這個策略的核心是：**由工程師提供關鍵的程式片段與思考脈絡，再交由 AI 進行擴充與實作。**

**(他在白板上畫了一個流程圖：一個方框寫著「人類專家」，一個方框寫著「AI」，中間有一個雙向箭頭。)**

**Mr. Lin：** 讓我們用一個具體的例子來說明。PCB 模擬的第一步，往往是處理複雜的疊構 (Stackup)。傳統做法是在 Stackup Editor 裡面手動一層一層地去編輯，對吧？

**Alex：** 對，非常繁瑣。尤其當疊構需要頻繁修改時，簡直是惡夢。

**Mr. Lin：** 好。現在我們想用 PyEDB 來自動化這個過程。如果直接問 AI：「幫我寫個讀取 Excel 並建立 PCB 疊構的 PyEDB 腳本」，它很可能會碰壁，因為它不知道 PyEDB 中操作 Stackup 的確切語法，也不知道一個「好」的 Excel 格式應該長什麼樣子。

**Mr. Lin：** 但是，如果我們換一種方式呢？身為專家的我，先做兩件事：
第一，我定義一個清晰、結構化的 Excel 範本。例如，包含 Layer Name, Type (Signal/Dielectric), Material, Thickness, Etch Factor 等欄位。這就是我們的「資料」。

**(Mr. Lin 在白板上畫了一個類似 Excel 表格的圖案。)**

**Mr. Lin：** 第二，我不需要寫出完整的自動化腳本。我只需要提供一個最核心、最關鍵的「程式碼片段」。比如，我會寫一小段 Python 代碼，展示如何用 PyEDB 的語法，去修改 EDB 中「單一」一個 Dielectric Layer 的厚度與材料。這段代碼可能只有十幾行，但它包含了最關鍵的 API 呼叫和物件操作邏輯。這就是我們的「思考脈絡」或「程式碼範例」。

**(他在流程圖的「人類專家」方框下寫下：「1. 定義 Excel 資料格式」、「2. 提供核心 PyEDB 代碼片段」。)**

**Mr. Lin：** 現在，神奇的部分來了。你，Alex，作為開發者，把這兩樣東西一起交給 AI。你的指令 (Prompt) 不再是模糊的「幫我做事」，而是非常具體的：「**這是一個用來操作 PCB 疊構中單一層的 PyEDB 函數範例 (附上代碼片段)。這是一個定義完整 PCB 疊構的 Excel 檔案格式 (附上格式說明)。請你結合這兩者，寫一個完整的 Python 函數，這個函數能夠讀取這種格式的 Excel 檔案，然後自動化地、從無到有地在一個 AEDB 檔案中建立或改寫整個 PCB 疊構。**」

**Alex：** (眼睛一亮) 我明白了！這就像是給 AI 一個「食譜」和「關鍵食材」，而不是讓它自己去菜市場亂逛。我們提供了最核心的工程知識——也就是那個操作單一層的 PyEDB 語法，這是 AI 最缺乏的。同時，我們也提供了結構化的數據藍圖——那個 Excel 格式。AI 的任務，就從「創造」變成了「遵循指令、擴充實作」。它擅長的是解析結構化資料、編寫循環 (Loop)、處理檔案讀寫這些通用的編程任務。

**Mr. Lin：** 正是如此！這個流程，我們可以稱之為「資料導向編程」。開發者提供資料（Excel）與程式碼片段（專家知識），AI Agents 負責分析與實作（編碼），而使用者（也就是你和你的團隊）則負責最後的測試與驗證。這樣一來，AI 的價值就被極大地放大了。你不再跟它產出的垃圾代碼搏鬥，而是把它當成一個高效的助手，幫你完成那些重複性高、但邏輯清晰的編碼工作。

**Alex：** 這個思路太棒了！針對像是疊構設定這種單一功能，用這種模式，即便是現在的 ChatGPT 對話模式，應該也還算堪用。我們回去馬上就可以試試看。但是……(Alex 的眉頭又微微皺起) Mr. Lin，我們的目標是端到端的全自動化。一個完整的模擬流程，遠不止設定疊構這麼簡單。它還包括：設定材料庫、根據 Net Name 批次定義 Port、配置複雜的 Solver 選項（比如頻率掃描範圍、收斂標準）、模擬結束後自動後處理（比如計算眼圖、提取特定頻點的 S-parameter）、甚至最後要產出一份圖文並茂的 PowerPoint 報告。這一整套流程，環環相扣，上下文關聯極強。我們該如何將這種「專家引導」的模式，擴展到如此複雜的系統級任務上呢？用單純的對話模式來回貼代碼，恐怕很快就會陷入混亂。

**Mr. Lin：** (露出讚許的笑容) 你問到了下一個關鍵點。當任務從「單一功能模組」升級為「完整工作流程」時，我們就需要引入一個更強大的架構——**AI Agents**。

**(Mr. Lin 擦掉白板上的圖，準備畫一個更複雜的架構圖。)**

**Mr. Lin：** 想像一下，ChatGPT 像是一個知識淵博但沒有記憶力的顧問，你每次問問題，都得把所有前因後果再講一遍。而 ChatGPT Codex 則像是一個專案經理，它長期跟你合作，並且在Github的倉庫中記錄每一次合作，當你用到他時，他會去翻找過去的合作紀錄及工作備忘錄。這個「專案經理 Agent」的核心能力是：**追蹤上下文、管理任務清單、串聯各個功能模組**。

**(他在白板中央畫了一個大圓圈，標上「AI Agent」。周圍畫了幾個小圓圈，分別標上「Stackup」、「Material」、「Port」、「Solver」、「Post-Processing」。)**

**Mr. Lin：** 我們要如何「管理」這個 AI Agent 呢？答案不是靠聊天，而是靠一份嚴謹的「開發規格文件」。我們可以建立一個叫做 `agents.md` 的 Markdown 檔案。這個檔案，就是我們整個自動化流程的「總設計藍圖」。

**Alex：** `agents.md`？用 Markdown 檔案來當作 AI 的規格書？這很新穎。

**Mr. Lin：** 是的。在這個檔案裡，我們會用清晰的、結構化的語言，定義整個流程。比如：

```markdown
# 專案: Project-X SI 自動化模擬流程

## 階段一: 前處理 (PyEDB)

### 任務 1.1: 導入設計
- **目標:** 導入 ODB++ 檔案。
- **工具:** Edb()。
- **產出:** `design.aedb` 檔案夾。

### 任務 1.2: 疊構設定
- **目標:** 根據 `stackup.xlsx` 檔案自動設定 PCB 疊構。
- **執行腳本:** `automation/stackup_builder.py`
- **輸入:**
  - `project_path/design.aedb`
  - `project_path/config/stackup.xlsx`
- **成功標誌:** `design.aedb` 中的疊構與 Excel 一致。

## 階段二: Port設置 (PyEDB)

### 任務 2.1: Port設置
- **目標:** 根據 `ports.json` 為專案中的元件設定激勵。
- **執行腳本:** `automation/port_assigner.py`
...

```

**Mr. Lin：** 你看，這份 `agents.md` 檔案，就是人與 AI Agents 之間最清晰的溝通橋樑。它詳細定義了每一個步驟的目標、需要執行哪個腳本、輸入是什麼、輸出是什麼、以及任務之間的依賴關係。

**Alex：** 我懂了！所以，那個「AI Agent」的工作，就是讀取和解析這個 `agents.md` 檔案。它就像一個有明確方向的開發者，按圖索驥，一步一步地去生成代碼。

**Mr. Lin：** 完全正確。而我們開發者的工作，就從「寫一個龐大而複雜的單體腳本」，轉變為「開發一系列小而美的、專注於單一任務的功能模組」，比如 `stackup_builder.py`, `port_assigner.py` 等等。在開發這些小模組時，我們就可以大量運用前面提到的「資料導向編程」模式——由我們提供核心片段，讓 AI 助手（比如 ChatGPT Codex）來補完大部分的樣板代碼。

**Alex：** 這樣一來，整個開發流程就變得非常結構化和可管理了。而且，我們可以把 `agents.md` 和所有的 Python 腳本都納入 Git 進行版本控制。每一次對模擬流程的修改，都會有清晰的紀錄。這對於團隊協作和知識傳承來說，價值巨大。

**Mr. Lin：** 是的。這套體系，我們可以把它與現代軟體開發的最佳實踐結合起來。用 **GitHub** 來管理我們的代碼和 `agents.md` 規格文件。在開發單一功能模組時，用 **Codex** 作為我們的 AI 編程助手。當需要與其他系統（比如公司的 PLM 產品生命週期管理系統，或材料資料庫）交換數據時，我們可能會用到 **REST API**。最後，當整套自動化流程開發完成後，我們甚至可以開發一個簡單的 **網頁前端 (Web GUI)**，比如用 Streamlit 或 Flask，讓團隊裡其他不熟悉程式碼的工程師，也能透過點擊按鈕、上傳檔案的方式，來執行這整套複雜的 AI Agent 自動化流程。

**Alex：** (深吸一口氣，眼神中充滿了對未來的想像) Mr. Lin，您描繪的這幅藍圖，徹底改變了我對模擬自動化的看法。這已經遠遠超出了「寫腳本」的範疇，而是一套完整的、結合了工程、軟體開發、AI 和 DevOps 的現代化工作體系。這也意味著，未來從事 AI 輔助模擬開發的工程師，需要具備的技能也將完全不同。

**Mr. Lin：** 沒錯。這也是我最後想跟你分享的。未來的「AI 輔助模擬開發者」，或者我稱之為「模擬自動化架構師」，將會是一個跨領域的關鍵人才。他需要具備 T 型的知識結構。

**(Mr. Lin 在白板上畫了一個大大的字母 T。)**

**Mr. Lin：** **T 的垂直部分，是你的「深度」**。這代表你必須對自己的核心領域有深刻的理解。對你來說，就是電磁物理、高速電路設計、以及 ANSYS 模擬工具本身。這是根基，不可動搖。你必須是個優秀的模擬工程師，才能判斷 AI 生成結果的對錯，才能提供有價值的「核心代碼片段」。

**Mr. Lin：** **T 的水平部分，是你的「廣度」**。這代表你需要掌握一系列的跨領域知識。你不必樣樣精通，但你必須「懂得如何運用」。這包括：
*   **Git/GitHub：** 用於協作與版本控制，這是現代開發的基礎。
*   **REST API：** 懂得如何讓你的自動化系統與外部世界溝通。
*   **網頁開發基礎 (Flask/Streamlit)：** 能為你的工具打造一個友善的使用者介面。
*   **雲端與部署 (Cloud/DevOps)：** 知道如何將你的自動化流程部署到伺服器或雲端，實現 7x24 小時的無人值守運行。

**Mr. Lin：** 最重要的是，這個角色的核心能力，不再是「親手寫好每一行代碼」，而是「**懂得如何引導 AI 執行、如何有效地拆解任務、如何將 AI 產出的模組串聯成一個穩健的系統**」。他是一個指揮家，而不是一個樂手。他將成為串聯起工程、模擬、自動化與 AI 能力的關鍵樞紐。

**(會議室裡一片寂靜，只有空調的微風聲。Alex 凝視著白板上那複雜而清晰的架構圖和那個 T 型人才模型，彷彿看到了一條通往未來的清晰技術路徑。)**

**Alex：** Mr. Lin，今天這番對話，對我的啟發實在太大了。您不僅解決了我眼前的困惑，更為我們團隊指明了一個長期的、戰略性的發展方向。從「資料導向編程」的小處著手，到「AI Agents」的宏大架構，再到對未來人才技能的要求，這是一套完整的方法論。我現在感覺充滿了動力，也知道我們該從哪裡開始了。

**Mr. Lin：** (微笑著走回座位) 很高興能對你有幫助。羅馬不是一天造成的。我建議你們可以從我們今天討論的「PCB 疊構自動化」作為第一個試點專案。你們團隊負責定義好 Excel 格式，以及思考整個流程。我可以提供一些 PyEDB 操作 Stackup 的核心範例代碼給你們當作起點。先用這個小專案，跑通「專家引導、AI 實作、開發者驗證」的流程。一旦成功，你們就有了信心和經驗，去逐步挑戰更複雜的任務，最終搭建起屬於你們自己的 AI Agents 自動化平台。

**Alex：** 太好了！這正是我們需要的。我們回去後會立刻著手規劃，定義好我們的 `stackup.xlsx` 格式。非常期待能得到您的代碼範例支援。

**(兩人站起身，再次用力地握手。這次的握手，不僅是禮貌，更傳遞著一種對技術未來的共識與興奮。)**

**Alex：** 再次感謝您，Mr. Lin。這是我今年以來最有價值的一次技術交流。

**Mr. Lin：** 不客氣，Alex。期待看到你們的成果。在探索 AI 與工程結合的這條路上，我們都是先行者。保持溝通。

**(Alex 帶著滿滿的收穫和清晰的藍圖，轉身離開了會議室。陽光透過玻璃窗灑在白板上。一場關於工程模擬的全新方向，正悄然拉開序幕。)**




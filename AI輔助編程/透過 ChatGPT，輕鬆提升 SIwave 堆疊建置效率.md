透過 ChatGPT，輕鬆提升 SIwave 堆疊建置效率
---

我在公司負責 SI/PI 模擬，其中一項重要工作是建立 SIwave 的PCB模型。以前 Layout 工程師給的PCB堆疊層資訊常常不夠精確，我們必須根據 PCB 製造商提供的資料一層層手動修正。為了模擬更準確，我還得在圖形介面（GUI）裡手動設定像是粗糙度 (roughness)、蝕刻因子 (etch factor) 等細節。

如果是三十層以上的大型板子，這些重複又繁瑣的動作非常耗時，一不小心就可能因為疲勞而輸入錯誤。

後來我發現，SIwave 其實可以把堆疊設定匯出成 XML 檔案，或是從 XML 匯入。於是我試著把目前設定匯出來仔細研究。結果發現，整個 XML 滿滿是標籤，看得讓人眼花撩亂。因為 XML 結構非常嚴謹，只要漏掉一個小細節，整份檔案就匯不進去；而且要修改像介電常數這類的數值，還得鑽到好幾層巢狀結構中，非常麻煩。

![2025-04-27_09-45-27](/assets/2025-04-27_09-45-27.png)

![2025-04-27_09-43-45](/assets/2025-04-27_09-43-45.png)

這時我想到，如果能用大家熟悉的 Excel 來編輯堆疊資料，不僅可以一目了然地篩選、修改，還能用公式幫忙檢查，豈不是更有效率？只要能從 Excel 轉回 XML，就能結合人性化操作與機器格式的優點。

但是，要怎麼設計 Excel 格式？材料資料和堆疊層資訊要分開嗎？轉換腳本又要怎麼寫？

為了找答案，我把匯出的 XML 上傳給 ChatGPT，並提出明確需求：

```
請根據這份 SIwave Stackup XML 提供以下內容：
1. Excel 格式（Materials、Layers 兩個工作表）的欄位設計
2. Python 3.10 腳本，可以把 Excel 轉成 SIwave 相容的 XML
3. 一份含 30 種材料、100 層堆疊的範例 Excel 檔案
```

不到半分鐘，ChatGPT 就回應了：

- 一份包含 30 種材料與 100 層的 Excel 範例檔
- `excel_to_stackup_xml.py` 腳本：使用 pandas 讀取 Excel，自動分辨是材料還是層資料，並正確產生帶有命名空間 `xmlns:c` 和 `schemaVersion` 的 XML
- 簡單清楚的使用說明

![2025-04-27_09-47-30](/assets/2025-04-27_09-47-30.png)

我將檔案放進工程專案資料夾，打開虛擬環境，安裝好 pandas，然後執行：

```
python excel_to_stackup_xml.py stackup_30mat_100layer.xlsx
```

結果終端機很快就顯示：「✅  已輸出：stackup\_30mat\_100layer.xml」。我打開 SIwave，匯入這份 XML，100 層堆疊一次載入成功，所有設定正確無誤。

![2025-04-27_09-49-58](/assets/2025-04-27_09-49-58.png)

整個流程從頭到尾，不到二十分鐘，比起以前需要半天以上的工作，效率提升非常明顯。

現在如果要修改堆疊，只要在 Excel 修改資料，再跑一次腳本就好。比起過去逐層修改，省時又不容易出錯。更棒的是，Excel 檔可以放進 Git 管理，每一次修改都有 commit 記錄；配合 CI pipeline，還能在每次 commit 後自動產生新的 XML 檔案，流程完整又現代化。

雖然我不是 Python 編程專家，但這次靠著 ChatGPT 的幫助，我連一行程式都沒自己寫，就解決了困擾我許久的大問題。即使 XML 本身還是複雜，但有了自動化產生的腳本，我再也不需要人工一個個去修改，大大提升了整體工作效率。


PCB 電源分配網路（PDN）Y 參數與 Loop Impedance 全解析
---
### 1. 前言

在高速數位電路設計中，確保 CPU 與高速 IC 的穩定供電是極為嚴峻的挑戰。隨著運算負載的動態變化，耗用電流會劇烈波動，此時 PDN（Power Distribution Network）的核心目標便是維持穩定的電源電壓。為精確評估 PDN 是否能滿足此嚴苛要求，工程師普遍採用 Y 參數與迴路阻抗（Loop Impedance）進行分析。這不僅是 SI/PI（Signal Integrity / Power Integrity）領域的黃金標準，更是現代電源完整性設計不可或缺的基石。

### 2. 從物理結構到等效模型

考量 CPU 及 VRM 的 PCB 疊層設計，其基本供電迴路由以下關鍵層構成：

* **PWR（Power）層**：負責提供穩定的工作電壓。
* **GND（Ground）層**：作為主要的電流回流路徑。

當 CPU 執行運算時，電流從 VRM 經由 PWR 層傳輸至 CPU 進行耗用，隨後透過 GND 層回流，形成一個完整的 PDN 供電迴路。然而，由於 PDN 並非理想導體（即存在非零阻抗），一旦電流發生劇烈變動（di/dt），便會不可避免地在 PDN 上產生瞬態壓降（Transient IR Drop）與電源雜訊（Power Noise）。這正是精確掌握 PDN 阻抗特性在高速設計中至關重要的原因。


![2025-05-25_08-50-56](/assets/2025-05-25_08-50-56.png)
### 3. 為什麼要用 Y 參數分析 PDN？

#### 3.1 Y 參數 vs Z 參數——本質差異

* **Y 參數（導納矩陣）**：其核心定義為「在觀察端口進行測量時，所有其他非觀察端口均處於短路（Short-Circuit）狀態」。這種條件完美模擬了 PDN 在實際運作中多個負載點同時從電源層汲取電流並透過地層回流的真實情境。特別地，從電路學角度來看，**VRM 為理想電壓源，其等效模型在交流分析中等價為短路**，這也強化了使用 Y 參數時的物理合理性。此外，雖然 Y 參數是導納的表示方式，但工程師在實務上更習慣以阻抗（如歐姆）為理解基礎，因此常先以 Y 參數建立模型，再取其倒數以求得 Loop Impedance，便於進行設計判斷與驗證。
* **Z 參數（阻抗矩陣）**：則預設非觀察端口全部「開路（Open-Circuit）」。然而，在真實的 PDN 環境中，這種單一端口獨立運作且其他端口完全斷開的條件極少發生，因此無法準確反映多點同時連接與交互作用的複雜情境。不過，在某些特定應用中，例如計算 PDN 的等效電容時，為了模擬電壓源處於開路狀態，則必須使用 Z 參數進行轉換，才能正確評估高頻條件下的電容特性。

#### 3.2 工程含義

對於 CPU 而言，其核心需求是即便在動態電流變化下，端口電壓仍能保持極度穩定。這意味著當 CPU 端口「拉取瞬態電流」時，所引起的電壓波動必須被抑制到最小。從電路特性來看，這直接對應到阻抗（Z）越小越好，或等效地，導納（Y）越大越好的設計目標。

因此，在實際的 PDN 仿真與驗證中，Y 參數被視為衡量 PDN 性能的基礎，而 Loop Impedance 則精確定義為 \$\frac{1}{Y}\$，這才能忠實反映電源完整性設計的工程現實與挑戰。

### 4. Loop Impedance 的定義與正確計算（含公式與說明）

根據 ANSYS 官方技術文件與標準定義，Loop Impedance 及其相關參數的計算方式如下：

#### 4.1 迴路阻抗（Loop Impedance）

$$
Z_{\text{Loop}}(f) = \left| \frac{1}{Y(P1, P1, f)} \right|
$$

#### 4.2 迴路電感（Loop Inductance）

$$
L_{\text{Loop}}(f) = \frac{\operatorname{Im}\left[\frac{1}{Y(P1, P1, f)}\right]}{2\pi f}
$$

#### 4.3 迴路電阻（Loop Resistance）

$$
R_{\text{Loop}}(f) = \operatorname{Re}\left[\frac{1}{Y(P1, P1, f)}\right]
$$

#### 4.4 等效電容（Capacitance）

$$
C_{\text{eq}}(f) = \frac{\operatorname{Im}\left[\frac{1}{Z(P1, P1, f)}\right]}{2\pi f}
$$

> **核心要點：** Y 參數的計算模型嚴格預設，除了被觀察的單一端口外，所有其他端口均處於短路狀態。這種設定是為了最大程度地貼近真實電路中多個 IC 或元件同時連接到 PDN 並共同工作的現實狀況，確保分析結果的準確性與實用性。

### 5. 物理意義與實務應用

#### 5.1 Loop Impedance 的測量與模擬

在 PDN 分析中，通常會在 CPU 端口施加一個瞬態電流源，並監測所引起的電壓響應，這正是阻抗的物理意義體現。

**設計要求：** 在所有預期的負載情境下，CPU 端口的 Loop Impedance 必須嚴格控制在目標規範之下（例如，在特定頻率範圍內低於 1 mΩ）。若未能滿足此要求，將極易導致嚴重的電壓暫降（Voltage Sag）、電源紋波（Power Ripple）甚至系統不穩定或功能失效。

#### 5.2 Y 參數與 Z 參數的工程選擇

* **Z 參數**：由於其「開路」的假設，在多負載並聯的真實 PDN 環境下，Z 參數分析往往會顯著低估實際的等效阻抗，從而可能導致錯誤的設計決策。
* **Y 參數**：其「短路」的假設則天然契合 PDN 的多端口並聯連接特性。因此，在 PI 領域，Y 參數的倒數被公認為衡量 PDN 迴路阻抗的標準方法。

#### 5.3 工具實務應用

此外，必須強調的是，Y、Z 與 S 參數本質上皆為等效網路的不同表徵形式，彼此可透過數學轉換互相轉換。在實際模擬流程中，軟體常先計算出 S 參數（散射參數），再透過後處理程序轉換為 Y 或 Z 參數，以便後續進行 Loop Impedance、電容估算等分析。這也意味著工程師在後處理階段仍可彈性選擇最適合的參數域進行深入分析。



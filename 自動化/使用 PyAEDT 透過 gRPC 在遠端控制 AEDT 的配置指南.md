使用 PyAEDT 透過 gRPC 在遠端控制 AEDT 的配置指南
---

PyAEDT允許使用者透過gRPC API在不同的電腦上遠端控制ANSYS Electronics Desktop（AEDT）進行模型建立、模擬和數據分析。這樣的設計使得近端電腦不需要安裝AEDT，只需通過網絡與遠端電腦上的AEDT進行通信。

>:link: **資訊連結**<br>[設定注意事項](https://aedt.docs.pyansys.com/version/0.8/Getting_started/ClientServer.html#client-server)

以下為關鍵步驟和設定，需要在近端和遠端電腦上完成，以確保兩者能夠順利連接： 
1. **安裝需求** ：
- 遠端電腦上必須安裝ANSYS Electronics Desktop、Python和PyAEDT。
- 近端電腦需要安裝Python和PyAEDT庫。 
2. **配置遠端伺服器** ：
- 在遠端電腦上啟動ANSYS Electronics Desktop的gRPC服務。
- 確保防火牆設定允許透過特定端口進行通信。 
3. **網絡設定** ：
- 確保近端電腦和遠端電腦可以通過網路相互連接。
- 適當配置路由器或防火牆，以允許gRPC通信。 
4. **使用PyAEDT進行連接** ：
- 在近端電腦上的Python環境中，使用PyAEDT建立一個到遠端AEDT伺服器的連接。
- 透過gRPC API發送指令，進行模型建立、模擬或數據抓取等操作。

這種架構不僅提高了計算資源的利用效率，同時也使得用戶可以在不具備高性能計算能力的電腦上進行複雜的電子設計自動化（EDA）任務。此外，透過網絡分離計算任務，也增加了工作的彈性與可擴展性。

> 啟動伺服器後，會顯示相關的IP地址和端口號。客戶端在執行時，必須連接到這指定的IP和端口，以確保能夠正確與伺服器進行通信。


### 測試連結

為了測試遠端伺服器的gRPC端口是否已正確開放，您可以在運行server的同一台電腦上，開啟另一個Python控制台並執行以下代碼啟動client連接。這段代碼將嘗試創建一個本地至本地的session，如果連接失敗，很可能是安裝或設定有誤。這是一個初步的疑難排解步驟。

![2024-04-23_11-05-44](/assets/2024-04-23_11-05-44.png)

如果在伺服器上的本地測試（client-server連結）正常運作，但外部電腦的客戶端無法連接到伺服器，那麼可能存在幾個潛在的問題。這裡有幾個步驟和考慮因素來幫助您進一步疑難排解： 
1. **防火牆設置** ：
- 確保伺服器的防火牆允許從外部IP地址到設定的gRPC端口（在此例中為17878）的流量。
- 檢查外部客戶端所在的網絡也沒有防火牆規則阻擋發送到伺服器的通信。 
2. **路由和網絡設置** ：
- 確認網絡路由設置正確，外部客戶端的網絡能夠找到並訪問到伺服器的IP地址。
- 如果伺服器位於NAT後面，確保適當的端口轉發已經設置好。 

透過這些步驟，您應能進一步縮小問題的範圍，並找到造成外部客戶端無法連接到伺服器的原因。
使用者定義文件
---

User Defined Documents (UDDs) 是一種透過 IronPython 腳本自定義報告的功能。這種腳本一旦放置在 Lib 目錄中，就可以透過「創建文檔」命令來訪問。這些腳本描述了一個「創建用戶定義文檔」對話框，讓你可以指定追踪和解決方案的輸入。確認輸入選擇後，系統會生成 HTML文件，並自動用網頁瀏覽器打開以顯示生成的 HTML 文件。創建的文檔會出現在 Project Manager 的 Results 目錄下的 Documents 文件夾中。

這個過程使得用戶可以根據特定需求定制化報告和文檔，提高工作效率和報告的可定制性。

![2024-08-25_06-48-37](/assets/2024-08-25_06-48-37.png)

![2024-08-25_06-49-34](/assets/2024-08-25_06-49-34.png)

```python
from Ansys.Ansoft.DocGeneratorPluginDotNet.DocGenerator.API.Data import *
from Ansys.Ansoft.DocGeneratorPluginDotNet.DocGenerator.API.Interfaces import *
from DesignSummaryBase import DesignSummaryBase

import os
from datetime import datetime


class UDDExtension(DesignSummaryBase):
    def __init__(self):
        DesignSummaryBase.__init__(self)
        
        
    def Generate(self, input, docgen, progMon):
        oDesign = self.GetUDDDesignContext()
        
        x = os.path.basename(docgen.GetOutputFilePath())
        html_path = os.path.join(docgen.GetOutputFilePath(), '{}.html'.format(x))

        current_datetime = datetime.now()

        with open(html_path, 'w') as f:
            f.writelines(str(current_datetime) + '<br>')
            f.writelines(oDesign.GetName() + '<br>')
            
        return True
```
自動產生每個模型物件的磁場強度圖並輸出為圖片檔
---

這段程式碼的目的是在 Ansys Maxwell 3D 模擬環境中，自動針對每一個模型中的物件產生磁場強度（Mag\_J）分佈圖，並將其以圖片檔形式儲存，供後續觀察與分析使用。

![d](/assets/2025-09-10_08-57-42.png)

### 功能

* 初始化並啟動指定版本的 Maxwell3D 工程
* 逐一處理模型中的所有物件
* 為每個物件建立磁場（Mag\_J）分佈圖
* 設定顏色圖的數值範圍與等級
* 匯出圖片到指定資料夾
* 清除繪圖資源避免記憶體累積

### 流程架構

1. 匯入 `Maxwell3d` 類別，並建立一個 Maxwell 專案實例。
2. 使用 `modeler.object_list` 取得目前模型中所有的幾何物件。
3. 對每個物件：

   * 建立一個磁場（Mag\_J）分佈的表面圖。
   * 設定顏色標度範圍從 `1e7` 到 `3e7`，並使用 50 個顏色等級。
   * 將圖輸出成圖片檔案，儲存在 `D:/demo/` 資料夾中，檔名為該物件的名稱。
   * 最後刪除該圖，以避免記憶體或視覺化資源堆積。

### 補充說明

* `Mag_J` 是 Maxwell 中表示電流密度 (J) 的磁場強度。
* `create_fieldplot_surface` 是用來產生場分佈圖的常用方法，通常用在後處理階段。
* `change_plot_scale` 設定的是圖的顏色映射範圍，讓圖片在視覺上更具可辨識性。
* `export_image` 中的 `orientation='top'` 指定拍攝角度為模型的上視圖。
* `plot.delete()` 是良好習慣，確保後處理過程中不會產生過多的暫存圖形。

### 範例程式

```python
from ansys.aedt.core import Maxwell3d

# 建立 Maxwell3D 專案（指定版本）
maxwell = Maxwell3d(version='2025.2')

# 逐一處理模型中的所有物件
for obj in maxwell.modeler.object_list:
    # 建立磁場強度（Mag_J）圖
    plot = maxwell.post.create_fieldplot_surface(quantity='Mag_J', assignment=obj)
    
    # 設定顏色對應的數值範圍和等級
    plot.change_plot_scale(1e7, 3e7, scale_levels=50)

    # 匯出圖片
    plot.export_image(f'd:/demo/{obj.name}.png',
                      selections=obj.name,
                      orientation='top',
                      show_region=False)

    # 刪除圖形以釋放資源
    plot.delete()
```

![ee](/assets/2025-09-10_09-00-42.png)